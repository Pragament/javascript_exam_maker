<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exam Question</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header>
    <h1>Exam Question</h1>
  </header>

  <main>
    <div id="assigned-questions-section" class="card">
      <h2>Your Assigned Questions</h2>
      <div id="assigned-questions-container" class="cards-container">
        <!-- Assigned questions will be loaded here -->
      </div>
    </div>

    <div id="question-selection" class="card">
      <h2>Available Questions</h2>
      <div id="questions-container" class="cards-container">
        <!-- Questions will be loaded here -->
      </div>
    </div>

    <div id="question-view" class="card" style="display: none;">
      <h2>Question Details</h2>
      <div id="question-details">
        <!-- Question details will be loaded here -->
      </div>
    </div>
  </main>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="js/firebase-config.js"></script>
  <script src="js/student-view.js"></script>
  <script>
  window.addEventListener("DOMContentLoaded", () => {
    const observer = new MutationObserver(() => {
      document.querySelectorAll('button').forEach((btn) => {
        if (btn.textContent.trim() === 'Select This Question' && !btn.dataset.bound) {
          btn.dataset.bound = "true";
          btn.addEventListener('click', () => {
            window.postMessage({ type: 'START_SCREEN_RECORDING' }, '*');
          });
        }
      });
    });

    observer.observe(document.body, {
      childList: true,
      subtree: true
    });
  });

  window.addEventListener("message", function(event) {
    if (event.data.type === "RECORDING_STOPPED") {
      alert("Recording saved. Please select the next question.");
      const params = new URLSearchParams(window.location.search);
      const examId = params.get("examId");
      if (examId) {
        window.location.href = `student.html?examId=${examId}&msg=recording_saved`;
      } else {
        window.location.href = "student.html?msg=recording_saved";
      }
    }
  });
</script>


</body>
</html>